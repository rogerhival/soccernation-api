<!--
How to use this test file:
	- Move it to C:\inetpub\wwwroot
	- Change the URL localhost port to your local one
	- if you can't access the URL, you probably missing "app.UseCors(options => options.WithOrigins("*").AllowAnyMethod());" on Startup.cs
-->

<html>
<head>
	<title>Soccer Test</title>

	<style>
		table, th, td {
			border: 1px solid grey;
			border-collapse: collapse;
			padding: 5px;
		}

			table tr:nth-child(odd) {
				background-color: #f2f2f2;
			}

			table tr:nth-child(even) {
				background-color: #ffffff;
			}
	</style>

	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>
	<script>
		var mainApp = angular.module("mainApp", []);

		mainApp.controller("competitionsController", function ($scope, $http) {
			var urlComp = "http://localhost:65075/api/competitions";
				
			$http.get(urlComp).then(function (response) {
				$scope.competitions = response.data;
				},
				function myError(response) {
					$scope.errorMessage = 'statusText: ' + response.statusText + '... errorMessage: ' + response.errorMessage + '... myError: ' + response.myError;
				});

			$scope.fix = function (id) {	
				var urlPending = "http://localhost:65075/api/fixtures/competition/" + id + "/status/Pending";
				$http.get(urlPending).then(function (response) {
					 $scope.fixtures = response.data;
					},
					function myError(response) {
						$scope.errorMessage = 'statusText: ' + response.statusText + '... errorMessage: ' + response.errorMessage + '... myError: ' + response.myError;
					});

				var urlFinished = "http://localhost:65075/api/fixtures/competition/" + id + "/status/Finished";
				$http.get(urlFinished).then(function (response) {
					$scope.fixturesResult = response.data;
					},
					function myError(response) {
						$scope.errorMessage = 'statusText: ' + response.statusText + '... errorMessage: ' + response.errorMessage + '... myError: ' + response.myError;
					});
			}
		});
	</script>
</head>
<body>
<h2>SoccerNation</h2>
<div ng-app="mainApp">
	<div ng-controller="competitionsController">
		Select competition: <select ng-model="selectedCompetition" ng-options="x.name for x in competitions" ng-change="fix(selectedCompetition.id)"></select>
		<br /><br />
		<table>
			<tr>
				<th colspan="4">Fixtures</th>
			</tr>
			<tr>
				<th>status</th>
				<th>round</th>
				<th>teamHome</th>
				<th>teamVisitor</th>
			</tr>
			<tr ng-repeat="fixture in fixtures">
				<td>{{ fixture.status }}</td>
				<td>{{ fixture.round }}</td>
				<td>{{ fixture.teamHome.name }}</td>
				<td>{{ fixture.teamVisitor.name }}</td>
			</tr>
		</table>
		<br />
		<table>
			<tr>
				<th colspan="6">Results</th>
			</tr>
			<tr>
				<th>status</th>
				<th>round</th>
				<th>teamHome</th>
				<th>teamVisitor</th>
				<th>teamHome goals</th>
				<th>teamVisitor goals</th>
			</tr>
			<tr ng-repeat="fixture in fixturesResult">
				<td>{{ fixture.status }}</td>
				<td>{{ fixture.round }}</td>
				<td>{{ fixture.teamHome.name }}</td>
				<td>{{ fixture.teamVisitor.name }}</td>
				<td>{{ fixture.teamHomeScore }}</td>
				<td>{{ fixture.teamVisitorScore }}</td>
			</tr>
		</table>
	</div>
</div>


</body>
</html>